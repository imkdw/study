# 멀티 모달 LLM 이란

- 텍스트뿐 아니라 이미지, 비디오, 오디오 등 다양한 형식의 데이터를 이해하고 생성할 수 있는 LLM을 말함
- LLM의 뛰어난 언어 이해 능력과 추론 능력을 중심으로 다양한 형식의 데이터를 이해하고 생성하는 능력을 추가하는 방식으로 구현됨

<br>

# 멀티 모달 LLM의 구성요소

- 이미지 형식의 데이터를 `모달리티 인코더` / `입력 프로젝터` 통해서 텍스트로 변환해서 LLM에 입력함
- LLM의 출력은 기본적으로 텍스트인데 `출력 프로젝터`를 통해서 이미지 형태의 데이터 출력이 필요한지 판단함
- `모달리티 생성기`를 통해서 특정 데이터 형식의 출력을 생성하게됨
- `모달리티 인코더`, `LLM 백본`, `모달리티 생성기`는 학습에 많은 데이터와 연산량이 필요함
  - 멀티모달 LLM 학습 과정에서 파라미터를 업데이트하지 않고 사전 학습된 모델을 그대로 사용함
- `입력 프로젝터`, `출력 프로젝터` 위 3가지 구성요소를 연결하는 역할로 LLM 학습 과정에서 파라미터를 업데이트함으로써 멀티모달 이해와 생성 성능을 높임

<br>

### 모달리터 인코더 종류

- 이미지를 처리하는 모달리티 인코더로 한정하면 `비전 트랜스포머`가 가장 많이 활용됨
- 텍스트를 처리학 위해서 개발됨 트랜스포머 아키텍쳐를 이미지에 적요한 모델임
- 이미지를 `패치` 단위로 잘라서 마치 텍스트에서 단어를 처리하는 것과 같이 일렬로 나열해 입력을 처리함
- 이미지 패치의 경우 사전(vocabulary)을 구축하기 어려워서 선형 변환을 통해 이미지 임베딩 벡터로 변환해서 토큰 임베딩과 유사하게 만듬
- OpenAI에서 만든 CLIP 모델이 가장 많이 사용되는데 이는 이미지와 텍스트를 같은 벡터 공간에 임베딩하도록 만들어진 모델임

<br>

### LLM으로 이미지를 생성하기

- LLM의 생성결과를 바탕으로 이미지를 만들기 위해서는 `이미지 생성이 필요한지를 판단`하는 단계와, `어떤 이미지를 생성할지 정하는 단계`가 필요함
- 위 2개의 단계는 출력 프로젝터를 통해서 수행되고 이미지 생성이 필요한 경우는 이미지 생성 모델에 적절한 프롬프트를 생성하는게 출력 프로젝터의 역할임
- 출력 프로젝터를 통해서 생성된 이미지 생성 프롬프트는 모달리티 생성기에 전달되고 최종적으로 이미지를 생성함

<br>

# 멀티모달 LLM 학습 과정

- 멀티 모달 LLM을 만들기 위해서는 사전 학습된 텍스트 전용 LLM이 멀티 모달 입력과 출력을 지원하기 위해서 추가 훈련 단계를 거침
- 멀티 모달 LLM의 학습 과정은 LLM과 동일하게 `사전 학습`과 `지시 데이터셋을 활용한 지시 학습`으로 나뉨
