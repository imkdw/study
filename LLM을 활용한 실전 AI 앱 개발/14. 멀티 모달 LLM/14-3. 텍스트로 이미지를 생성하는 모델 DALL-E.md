# 디퓨전 모델 원리

- 디퓨전 모델은 확산 현상에서 영감을 받아서 만들어진 생성 모델임
- 디퓨전 모델은 이미지에서 어떤 부분이 노이즈인지 예측하는 방식으로 학습함
- 완전한 노이즈 상태의 이미지에서 노이즈를 에측하고 예측된 노이즈를 제거하면서 점차 완전한 노이즈에서 의미가 있는 이미지를 생성함

<br>

### 이미지에서 노이즈를 예측하는 디퓨전 모델

- 대표적으로 `U-Ne`t이라는 `인코더 디코더` 모델을 많이 사용함
- 인코더 디코더는 `입력 데이터의 차원을 낮추는 인코딩 단계`와 `차원을 높이는 디코딩 단계`를 통해 데이터의 의미를 압축하기 위해 사용되는 모델 구조를 뜻함
- U-Net은 인코더-디코더 구조를 변형해서 그림의 위치 정보가 손실되는 것을 막을 수 있다는 장점이 있음

<br>

### 완전한 노이즈 상태에서 노이즈 제거시 원하는 이미지를 생성하기?

- 사람이 원하는 이미지 생성을 위해서는 디퓨전 모델에 노이즈를 넣어주면서 원하는 결과물의 형태를 텍스트 임베딩으로 변환함
- 디퓨전 모델이 텍스트 임베딩을 참고해서 원하는 이미지를 생성하게됨
- 이때 디퓨전 모델에 넣어주는 추가 정보는 텍스트 임베딩이 될수도있고 이미지 임베딩이 될수도 있음

<br>

# DALL-E 모델

- CLIP 모델을 통해서 텍스트 임베딩을 만들고, 텍스트 임베딩을 활용해 두 단계를 거쳐서 이미지를 생성함
- CLIP의 텍스트 인코더를 통해서 입력한 텍스트를 임베딩화하고, `프라이어 모델`을 통해서 CLIP 이미지 임베딩을 만들고 디코더를 사용해서 이미지를 생성하는 구조

<br>

### 프라이어 모델

- 텍스트 임베딩을 입력으로 받아서 이미지 임베딩을 예측하는 `디퓨전 모델`임
- 텍스트 임베딩을 참조해서 노이즈 입력을 이미지 임베딩으로 변환함

<br>

### 디코더

- 디코더는 이미지 임베딩을 참조해서 이미지를 생성하는 `디퓨전 모델`임
- 디코러르 통해 생성된 출력 이미지는 저해상도의 이미지인데, DALL-E 2에서는 추가로 2개의 디퓨전 모델을 통해서 저해상도 이미지를 고해상도 이미지로 변환함

<br>

### 꼭 프라이어 모델을 사용해야될까?

- 위 내용으로만 보면 굳이 중간에 프라이멀 모델을 거치지 않고 텍스트 또는 텍스트 임베딩을 바로 디퓨전 모델에 전달해서 이미지 생성도 가능함
- DALL-E 연구팀의 테스트 결과에 따르면 `입력한 텍스트를 이미지에 반영하는 정도`에서 차이가 난다고함
