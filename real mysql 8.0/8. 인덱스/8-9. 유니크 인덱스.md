# 유니크 인덱스

- 유니크는 사실 인덱스라기 보다는 제약조건에 가깝다
- MySQL에서는 인덱스 없이 유니크 제약조건만 만드는게 불가능하다

<br/>

# 유니크 인덱스 vs 일반 세컨더리 인덱스

### 인덱스 읽기

- 대부분이 유니크 인덱스가 빠르다고 생각하지만 틀렸다
  - 유니크는 1건만 읽으면 된다고 생각하고, 세컨더리는 레코드를 한건더 읽어야 하므로 느리다고 생각함
  - 하지만 이러한 비교작업은 디스크가 아닌 CPU에서 하는거라 차이가 미미하다
- 결국 읽어야 할 레코드의 건수가 비슷하다면 성능상의 차이는 미미하다

<br/>

### 인덱스 쓰기

- 유니크 인덱스는 중복된 값이 있나 없나 체크하는 과정이 한단계 더 필요함
  - 이러한 동작으로 인해 일반 세컨더리 인덱스 쓰기보다 느리다
- 유니크 인덱스는 중복된 값 체크시 읽기락, 쓰기시 쓰기락을 설정하는데 데드락이 빈번하게 발생함
- 원래는 인덱스 키 저장을 위해서 체인지버퍼를 통해 백그라운드 스레드에서 처리하지만 중복체크가 반드시 필요해서 작업 자체 버퍼링이 불가능함
- 위 이유로 유니크 인덱스는 일반 세컨더리 인덱스보다 변경 작업이 더 느리게 작동하게됨

<br/>

# 유니크 인덱스 사용시 주의사항

- 꼭 필요하면 유니크 인덱스를 생성하는건 당연하지만, 불필요하게 유니크 인덱스를 생성하는건 좋지 않음
- 유니크 제약을 건 컬럼에는 자동으로 인덱스가 생성되는데, 개별로 만든 인덱스와 동일한 역할을 함
- 유일성이 보장되어야 하는 컬럼에 대해서는 유니크를 설정하되, 유일성이 보장되지 않아도 된다면 세컨더리 인덱스 생성을 고려하자
