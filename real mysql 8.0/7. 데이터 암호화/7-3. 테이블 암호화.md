# 테이블 암호화

- 키링 플러그인은 마스터 키 생성, 관리만 담당해서 이후 테이블을 생성하고 활용하는 방법은 모두 동일함

<br/>

# 테이블 생성

- 테이블 생성시 맨 끝에 `ENCRYPTION='Y'` 옵션을 추가하면 된다
- `default_table_encryption` 설정을 활성화 하면 모든 테이블이 암호화되어 생성된다

```sql
create table encrypt_test (
	id int primary key auto_increment
) ENCRYPTION="Y";

SET default_table_encryption=OFF;
```

<br/>

# 어플리케이션 암호화랑 비교

- 앱에서 암호화 된 데이터를 저장하는 경우 인덱스를 100% 활용할 수 없다
- 디비단에서 암호화를 하는경우 인덱스 관련 작업을 모두 처리하고 최종 디스크에 데이터 페이지를 저장할때만 암호화하기 때문에 제약조건이 없다
- 유즈케이스 마다 다르지만 큰 제약이 없다면 디비단 암호화를 권장한다

<br/>

# 테이블 스페이스 이동

- 테이블 스페이스 이동이 레코드 덤프 후 다시 복구하는 방식보다 훨씬 빠르다
- 암호화가 되어있지 않은 테이블은 단순 명령어를 통해서 이동이 가능하다

### 암호화된 테이블 스페이스 이동

- `FLUSH TABLES <source_table> FOR EXPORT` 를 하게되면 임시로 사용할 마스터 키를 발급해서 `<source_table>.cfg`로 기록함
- 암호화된 테이블의 경우는 반드시 임시 마스터키가 저장된 파일도 같이 복사해야함
