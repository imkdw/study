# 포트와 어댑터

- 계층형 아키텍처의 단점을 해결하고 좀 더 복잡한 비즈니스 로직을 구현하는데 적합함
- 두 패턴은 배우 비슷하다

<br>

# 의존성 역전 원칙

- 비즈니스 로직을 구현하는 상위수준의 모듈은 하위 수준의 모듈에 의존해서는 안된다
- 비즈니스 로직 계층과 인프라스트럭쳐 계층 사이에 애플리케이션 계층을 추가한다
- 앱 계층은 시스템이 노출하는 모든 오퍼레이션을 설명하고 이를 실행할 시스템의 비즈니스 로직을 조율하게된다
- 이로써 도메인 모델, 이벤트 소싱 도메인 모델의 구현 요건에 따라서 비즈니스 로직은 어떤 하위 계층에도 의존하지 않게된다

<br>

# 인프라 구성요소의 연동

- 포트 앤 어댑터 아키텍처의 핵심은 인프라스트럭처 구성요소로부터 시스템의 비즈니스 로직을 분리하는 것이다
- 인프라스트럭처의 구성요소를 직접 호출하는 대신 비즈니스 로직 계층은 인프라스트럭처 계층이 구현해야 할 `포트`를 정의한다
- 인프라스트럭처 계층은 `어댑터`를 구현한다. 다양한 기술을 사용하기 위해서 정의된 포트의 인터페이스를 구체적으로 구현한다

<br>

### 추상 포트

- 추상 포트는 인프라스트럭처 계층에서 의존성 주입 또는 부트스트래핑을 통해서 구체적인 어댑터로 나타나게된다

```ts
interface IMessaging {
  publish(payload: Message): void;
  subscribe(type: Message, callback: Action): void;
}

export class SQSBus implements IMessaging {
  publish(payload: Message): void {}

  subscribe(type: Message, callback: Action): void {}
}
```

<br>

# 변형

- 포트 앱 어댑터 아키텍쳐는 `헥사고날`, `어니언`, `클린` 아키텍쳐로 알려져있음
- 위 아키텍쳐들이 동일하다고 해도 계층형 아키텍쳐에서와 마찬가지로 용어는 다른수도 있음
  - 앱 계층 = 서비스 계층 = 유스케이스 계층
  - 비즈니스 로직 계층 = 도메인 계층 = 핵심 계층

<br>

# 포트와 어댑터를 사용하는 경우

- 모든 기술적 관심사로부터 비즈니스 로직을 분리하는 것이 포트와 어댑터 아키텍쳐의 목적이다
- 도메인 모델 패턴을 사용해서 구현한 비즈니스 로직에 매우 적합하다
