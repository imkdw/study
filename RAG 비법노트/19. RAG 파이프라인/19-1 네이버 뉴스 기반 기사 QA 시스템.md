# 네이버 뉴스 기반 기사 QA 시스템
- 웹페이지의 정보를 가져와서 LLM에게 전달하여 QA가 가능함

```python
from dotenv import load_dotenv
from langchain_teddynote import logging

load_dotenv()

logging.langsmith("test")

# ==============================================

import bs4
from langchain import hub
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain_community.document_loaders import WebBaseLoader
from langchain_community.vectorstores import FAISS
from langchain_core.output_parsers import StrOutputParser
from langchain_core.runnables import RunnablePassthrough
from langchain_openai import ChatOpenAI, OpenAIEmbeddings
from langchain_teddynote.messages import stream_response

# WebBaseLoader를 통해서 네이버 뉴스 기사를 가져옴
loader = WebBaseLoader(
    web_paths=("https://n.news.naver.com/article/437/0000378416",),
    bs_kwargs=dict(
        parse_only=bs4.SoupStrainer(
            "div",
            attrs={"class": ["newsct_article _article_body", "media_end_head_title"]},
        )
    ),
)

docs = loader.load()

# 청크 크기는 1000으로 설정하고 중복되는 문자의 수는 100으로 설정
text_splitter = RecursiveCharacterTextSplitter(chunk_size=1000, chunk_overlap=100)

splits = text_splitter.split_documents(docs)

vectorstore = FAISS.from_documents(documents=splits, embedding=OpenAIEmbeddings())

retriever = vectorstore.as_retriever()

from langchain_core.prompts import PromptTemplate

prompt = PromptTemplate.from_template(
    """당신은 질문-답변(Question-Answering)을 수행하는 친절한 AI 어시스턴트입니다. 당신의 임무는 주어진 문맥(context) 에서 주어진 질문(question) 에 답하는 것입니다.
검색된 다음 문맥(context) 을 사용하여 질문(question) 에 답하세요. 만약, 주어진 문맥(context) 에서 답을 찾을 수 없다면, 답을 모른다면 `주어진 정보에서 질문에 대한 정보를 찾을 수 없습니다` 라고 답하세요.
한글로 답변해 주세요. 단, 기술적인 용어나 이름은 번역하지 않고 그대로 사용해 주세요.

#Question: 
{question} 

#Context: 
{context} 

#Answer:"""
)

llm = ChatOpenAI(model_name="gpt-4.1-mini", temperature=0)


rag_chain = (
    {"context": retriever, "question": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)

answer = rag_chain.stream("부영그룹의 출산 장려 정책에 대해서 설명해줘")

# 부영그룹은 2021년 이후 태어난 직원 자녀에게 1억원씩, 총 70억원을 지원하는 파격적인 출산 장려 정책을 시행하고 있습니다. 연년생이나 쌍둥이 자녀가 있을 경우 총 2억원을 받을 수 있으며, 셋째 아이까지 낳는 직원에게는 국민주택을 제공하겠다는 계획도 밝혔습니다. 또한, 출산장려금에 대한 직원들의 세금 부담을 줄이기 위해 정부에 면세를 요청하는 제안도 나왔습니다. 이 정책은 직원들의 경제적 부담을 덜어주고 출산을 장려하기 위한 회사 차원의 적극적인 지원책입니다.%
stream_response(answer)
```