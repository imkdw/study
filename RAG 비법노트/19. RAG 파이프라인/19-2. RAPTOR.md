# RAPTOR
- RAPTOR는 **Recursive Abstractive Processing for Tree-Organized Retrieval**의 약자다
- 트리로 구성된 검색을 위한 재귀적 추상 처리라는 뜻을 가짐
- 짧고 연속적인 텍스트 청크를 검색하는 방식은 문서 전체를 아우르는 내용 구조를 이해하는 능력이 떨어짐
- RAPTOR는 트리 구조를 만드는데 하위 레이어의 청크를 요약해서 클러스터를 만들고, 클러스터의 내용을 요약해서 상위 레이어의 요약본을 만드는 방식임

<br>

# RAPTOR 방식
- RAPTOR 트리는 낮은 수준의 리프 레이어에서 높은 수준의 루트 레이어에 이르는 여러 수준으로 구성됨
- 청크들은 일반적으로 100토큰 이하로 매우 작게 분할함
- 작게 분할된 청크들은 먼저 클러스터링 알고리즘을 통해 주제나 의미가 비슷한 것끼리 묶임
- 클러스터가 형성되면 각 클러스터에 속한 청크들을 임베딩하고 LLM을 통해서 요약을 수행함
- 이러한 과정을 반복해서 점점 더 상위 개념으로 압축되는 트리 구조가 완성됨

<br>

# 각 노드별 사용처
- 루트 노드는 전체 맥락에 대한 추상적 질문 처리에 활용하고 구체적인 질문은 리프 레이어 또는 중간 단계의 노드 정보로 처리함
- LLM이 발전함에 따라 토큰 제한이 매우 커졌는데 이 때 리트리버 방식을 사용하면서 하위 노드에서는 구체적인 내용을 처리하고 상위 노드에서 추상적인 내용을 처리하는 RAPTOR 방식이 효율적임
