# Pandas 데이터프레임 출력 파서
- pandas 데이터프레임에서 데이터를 추출하고 이를 형식화된 딕셔너리 형식으로 조회하며 연산 결과도 반환이 가능함


```python
from dotenv import load_dotenv
from langchain_teddynote import logging

load_dotenv()
logging.langsmith("langchain_test")

# ========================================================================

import pprint
from typing import Any, Dict

import pandas as pd
from langchain.output_parsers import PandasDataFrameOutputParser
from langchain_core.prompts import PromptTemplate
from langchain_openai import ChatOpenAI

model = ChatOpenAI(temperature=0, model_name="gpt-3.5-turbo")


def format_parser_output(parser_output: Dict[str, Any]) -> None:
    for key in parser_output.keys():
        parser_output[key] = parser_output[key].to_dict()
    return pprint.PrettyPrinter(width=4, compact=True).pprint(parser_output)


df = pd.read_csv("/Users/imkdw/study/RAG 비법노트/6. 출력 파서/titanic.csv")
df.head()

parser = PandasDataFrameOutputParser(dataframe=df)


df_query = "Age column 을 조회해 주세요."
prompt = PromptTemplate(
    template="Answer the user query.\n{format_instructions}\n{question}\n",
    input_variables=["question"],
    partial_variables={"format_instructions": parser.get_format_instructions()},
)

chain = prompt | model | parser
parser_output = chain.invoke({"question": df_query})

# {
#     "Age": {
#         0: 22.0,
#         1: 38.0,
#         2: 26.0,
#         3: 35.0,
#         4: 35.0,
#         5: nan,
#         6: 54.0,
#         7: 2.0,
#         8: 27.0,
#         9: 14.0,
#         10: 4.0,
#         11: 58.0,
#         12: 20.0,
#         13: 39.0,
#         14: 14.0,
#         15: 55.0,
#         16: 2.0,
#         17: nan,
#         18: 31.0,
#         19: nan,
#     }
# }
print(format_parser_output(parser_output))
```